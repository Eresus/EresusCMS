<?xml version="1.0" encoding="UTF-8"?>

<project name="eresus2" default="build" basedir=".">

	<property name="builddir" value="./build/" override="true" />
	<property name="distdir" value="./distr/" override="true" />

	<!-- Prepeare project for build -->
	<target name="prepare">

		<echo msg="Making directory ./build" />
		<mkdir dir="${builddir}" />

	</target>

	<!-- Build project -->
	<target name="build" depends="prepare">

		<echo msg="Copying main files..." />
		<copy todir="${builddir}">
			<fileset refid="main_files" />
		</copy>

		<echo msg="Copying libs..." />
		<copy todir="${builddir}core/lib">
			<fileset refid="libs_files" />
		</copy>

		<echo msg="Copying DB templates..." />
		<mkdir dir="${builddir}distrib" />
		<copy todir="${builddir}distrib">
			<fileset refid="db_files" />
		</copy>

		<echo msg="Copying locale files..." />
		<copy todir="${builddir}">
			<fileset refid="l10n_files" />
		</copy>

		<!-- echo msg="Copying 3rd party extensions..." />
		<copy todir="${builddir}">
			<fileset refid="3rdparty_files" />
		</copy>

		<echo msg="Copying SDK files..." />
		<mkdir dir="${builddir}distrib" />
		<copy todir="${builddir}distrib">
			<fileset refid="SDK_files" />
		</copy -->

	</target>

	<!-- Make distributive -->
	<target name="dist" depends="build">
		<echo msg="Creating distributives..." />

		<tar destfile="./build/build.tar.gz" compression="gzip">
			<fileset dir="./build">
				<include name="*" />
			</fileset>
		</tar>

		<echo msg="Files copied and compressed in build directory OK!" />
	</target>



	<!-- Main project files -->
	<fileset dir="main" id="main_files">
		<include name="**" />
		<exclude name=".svn" />
	</fileset>

	<!-- libs files -->
	<fileset dir="lib" id="libs_files">
		<include name="**" />
		<exclude name=".svn" />
	</fileset>

	<!-- DB templates -->
	<fileset dir="db" id="db_files">
		<include name="**" />
		<exclude name=".svn" />
	</fileset>

	<!-- l10n files -->
	<fileset dir="." id="l10n_files">
		<include name="lang/**" />
		<exclude name=".svn" />
	</fileset>

	<!-- 3rd party extensions -->
	<fileset dir="." id="3rdparty_files">
		<include name="ext-3rd/**" />
		<exclude name=".svn" />
	</fileset>

	<!-- SDK files -->
	<fileset dir="." id="SDK_files">
		<include name="SDK/**" />
		<exclude name=".svn" />
	</fileset>

</project>
