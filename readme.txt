Инструкция по установке Eresus 2.09 (31.05.07)

1.Установка с помощью инсталлятора
(В этой версии отсутствует)

2.Ручная установка
 Файлы дситрибутива загружаются на сервер в корневую папку сайта.

2.1.Установка прав доступа
  Для корректной работы системы требуется разрешить запись PHP-скриптам для ряда директорий и файлов. Как правило на UNIX-подобных системах для этого надо выставить права 0777 для директорий и 0666 для файлов.
  Разрешение на запись:
  / – запретить для файлов
  /cfg – разрешить для директории и файла settings.inc
  /core – запретить для директории, поддиректорий и файлов
  /data – разрешить для директории, поддиректорий и файлов
  /ext – разрешить для директории, поддиректорий и файлов
  /style – разрешить для директории, поддиректорий и файлов
  /templates – разрешить для директории, поддиректорий

2.2.Основной конфигурационный файл (cfg/main.inc)
  В файле /cfg/main.inc при необходимости изменить следующие константы:
   define('dbHost', 'localhost'); # Хост сервера БД, обычно localhost
   define('dbUser', 'root'); # Имя пользователя MySQL
   define('dbPswd', 'mysql'); # Пароль пользователя MySQL
   define('dbName', 'dvaslona'); # Имя базы данных MySQL
   define('dbPrefix', ''); # Префикс таблиц базы данных, обычно не требуется если эта же БД не используется другими скриптами

2.3.Импорт в базу данных
  В файле database.sql находится дамп, который надо импортировать в базу данных.
  Если в основном конфигурационном файле задана опция dbPrefix, то файл дампа надо предварительно отредактировать, добавив этот префикс ко всем именам таблиц.

2.4.Редактирование .htaccess
  Если система установлена в директорию отличную от корневой директории сайта, надо изменить соответствующим образом директивы ERROR_DOCUMENT.

3. ИСТОРИЯ ИЗМЕНЕНИЙ

  2.09
  [#] CLIENT - Неправильные пути для подстраниц главной страницы у типа страницы "Список подразделов".
  [#] KERNEL - Неправильная обработка кавычек в статических файлах.
  [#] ADMIN  - Исправлено оповещение о добавлении плагинов
  [#] KERNEL - Ошибочное экранирование кавычек в *.js и *.css файлах.
  [*] KERNEL - Отменен по умолчанию прямой доступ к файлам jpg,gif,jpeg,bmp,png,ico,zip,7z,rar. Теперь они доступны только из директорий data, style, core и ext. Из корня по умолчанию доступны только файлы robots.txt и favicon.ico
  [*] KERNEL - Режим отладки по-умолчанию отключен
  [*] CLIENT - Событие clientOnContentRender теперь вызывается непосредственно после генерации контента.
  [+] CLIENT - Выдача HTTP-заголовка с кодировкой
  [+] CLIENT - Добавлено событие clientBeforeSend, вызывающееся непосредственно перед отправкой страницы барузеру
  [+] KERNEL - В переменную $request добавлено поле "method", указывающее каким методом (GET, POST) был вызван скрипт
  [#] KERNEL - Исправлено неверное название раздела в e-mail оповещениях с КИ (thnx dr.Scre)
  
  2.08
  [#] CLIENT - Не отрисовывались формы ввода
  [*] ADMIN  - В управлении страницами у страниц с длинным названием, название сокращается до 31 сивола.
  [*] KERNEL - Изменен метод TMySQL->updateItem. Теперь поля, отсутствующие в аршументе $item, остаются неизмененными.
  [*] KERNEL - Функция arg теперь возвращает false, если аргумент не установлен.
  [+] KERNEL - Добавлена функция replaceMacros($template, $item), аналог TPlugin->replaceMacros, за исключением того, что $item может быть не только массивом, но и объектом.
  [*] KERNEL - Изменена функция upload. Добавлен необязательный третий аргумент overwrite, по умолчанию равный true (что обеспечивает обратную совместимость). Если файл с целевым именем уже существует, он  перезаписан если overwrite равен true, или его имя совпадает с переданным в overwrite. В противном случае имя целевого файла будет изменено так, чтобы быть уникальным. Кроме того, по умолчанию файлу задаются права доступа 0666 и в случае успеха возвращается имя загруженного файла, а не true.
  [+] KERNEL - Добавлена функция SendXML, отправляющая XML-документ и прерывающая работу скрипта.
  [+] KERNEL - В АИ JavaScript добавлены:
               - флаг isIE равный true если пользователь использует Internet Explorer
               - функции pageLeft и pageTop, возвращающие полное смещение узла относительно левого и верхнего краёв документа соответственно.
  [#] KERNEL - Баг с удалением обратных слэшей.
  [*] KERNEL - Функция sendMail, если не указан адрес отправителя, использует адрес no-repay@[имя_домена]
  [*] KERNEL - В функции sendMail кодировка для HTML-писем изменена с Quoted-Printable на base64
  [#] KERNEL - Мелкие исправления.

  2.07
  [+] KERNEL - Добавлен заголовок Content-type с указанием кодировки для не-HTML писем.
  [*] KERNEL - Метод TPlugins->load теперь в случае успеха возвращает указатель на созданный экземпляр класса модуля расширения
  [#] KERNEL - Исправлена ошибка, из-за которой создавался лишний экземпляр класса модуля расширения, добавлявшего свой пункт в меню "Расширения"
  [+] KERNEL - В языковой файл добавлена константа LOCALE_CHARSET, задающая набор символов, применяемый в функциях PHP и при работе с внешними хранилищами данных
  [+] KERNEL - В модуль mysql добавлен выбор кодировки соединения на основе LOCALE_CHARSET
  [#] ADMIN,CLIENT - исправлена ошибка при проверке пароля и подтверждения
  [+] ADMIN  - В менеджере файлов добавлена возможность переименования файлов
  [+] ADMIN  - В менеджере файлов добавлена возможность изменения прав доступа к файлам
  [+] KERNEL - Ко всем картинкам, вставляемым через визуальный редактор и не имеющим атрибута alt, он дописывается автоматически

  2.06
  [+] KERNEL - Добавлена возможность для ручного указания DOCUMENT_ROOT
  [*] KERNEL - gziph по умолчанию устанавливает Cache-Control в public
  [*] KERNEL - gziph выдает дату изменения обрабатываемого файла
  [+] KERNEL - gziph выдает Content-length
  [+] KERNEL - в .htaccess добавлено отключение кодировок (AddDefaultCharset Off)
  [+] KERNEL - gziph добавлен новый параметр - charset, устанавливающий кодировку файлов
  [*] ADMIN  - Обновлена версия визуального редактора Xinha:
  	       + Добавлены новые плагины: DynamicCSS, GetHtml, ImageManager, PasteText, TableOperations
  	       - В диалоге добавления ссылки убран элемент "target"
  [#] KERNEL - Исправлена ошибка в методе TAdminUI->renderPages
  
  2.05
  [*] CLIENT - Из форм убран атрибут name (в соответствии со стандартом XHTML)
  [*] CLIENT - Элементы hidden форм забраны в div с классом hidden (в соответствии со стандартом XHTML)
  [*] CLIENT - Ширина ячеек таблицы форм задается с помощью colgroup, а не img

  2.05b
  [#] ADMIN - Исправлена ошибка при перемещении позиций в таблицах
  [+] ADMIN - Обход ошибки в Internet Explorer при изменении порядка следования страниц
  [+] ADMIN - TAdminUI->renderTable - Добавлено кодирование символов HTML в макросах значений полей
  [*] CLIENT - Время обновления всегда ставится равным текущему для предотвращения кэширования страницы
  [*] KERNEL - FormatSize - для чисел меньше килобайта дробная часть не показывается
  [*] KERNEL - Максимальная длина полей title, hint, description и keywords для страниц увеличина с 255 до 65535 символов.
  [+] CLIENT - При открытии страниц типа URL, происходит автоматическая переадресация на новый адрес.

  2.01
  [#] KERNEL - Исправлена ошибка в методах TListContentPlugin->up и TListContentPlugin->down; 
  [#] ADMIN - Исправлены ошибки в шаблоне BrowseFile.tmpl - неверные action в формах; 
  [#] CLIENT - Не работали проверочные скрипты форм; 
  [#] CLIENT - Поле TClientUI->section не учитывало главную страницу; 
  [#] KERNEL - Функции getArgs и setArgs после появления нового механизма очистки ввода, работали некорректно; 
  [#] ADMIN - После удаления страницы показывался пустой диалог свойств страницы; 
  [#] ADMIN - WYSWYG редактор не сохранял пустые атрибуты alt у картинок; 
  [-] KERNEL - TClientUI - из JavaScript переменной iBrowser удалено поле JavaScript; 
  [*] CLIENT - Теперь тэги в формах ввода закрываются в соответствии со стандартом XHTML; 
  [+] KERNEL - Появилась возможность задавать текст на кнопках клиентских форм; 
  [*] ADMIN - Незначительные изменения в дизайне; 
  [*] ADMIN - Подсветка строки под курсором мыши переделана со скриптов на CSS; 
  [+] KERNEL - Добавлена функция HttpAnswer; 
  [*] ADMIN - Меню "Структура". Сделано множественое перемещение страниц (вверх-вниз) без перезагрузки страницы; 
  [*] KERNEL - Во время отрисовки страницы перед событием clientOnContentRender загруженный шаблон сохраняется в TClientUI->template; 
  [+] KERNEL - Добавлена обработка ошибок при загрузке файлов через upload; 
  [+] KERNEL - Добавлена функция Translit для транслитерации строк на основе таблицы, задаваемой в языковом файле; 
  [+] ADMIN - "Конфигурация -> Файлы" добавлена опция "Транслитерировать имена загружаемых файлов"; 
  [+] KERNEL - Функция upload будет автоматически транслитерировать имена загружаемых файлов если установлена опция filesTranslitNames и не указано явно имя целевого файла; 
  [+] KERNEL - Добавлена функция option возвращающая значение определенной опции. (Аналог устаревшей getOption, но с проверкой на существование опции); 
  [+] KERNEL - Добавлена возможность управления кэшированием в модуле gziph, для этого надо добавить параметр cache=тип_кэширования; 
  [*] KERNEL - Функции GetArgs добавлены два необязательных параметра - checkboxes (задает список полей checkbox) и (prevent - задает список полей, которые изменять не следует); 
  [*] KERNEL - Функция setArgs объявляется устаревшей. В место нее следует использовать GetArgs. Оставлена для обратной совместимости; 
  [+] KERNEL - Добавлена опция siteTitleDivider - разделитель элементов заголовка сайта; 
  [+] ADMIN - "Конфигурация -> Основное" добавлена настройка разделителя элементов заголовка сайта; 
  [+] KERNEL - Сделано автоматическое удаление контента страницы при ее удалении (только для дочерних элементов первого уровня, т.е. с section равным id страницы); 
  [+] ADMIN - В шаблоне для типа контента "Список подразделов" добавлены макросы и ; 
  [+] KERNEL - Для полей select и listbox в TClientUI->renderForm теперь если не задано значение items, оно будет взято из values; 
  [+] KERNEL - Для полей select и listbox в TAdminUI->renderForm теперь если не задано значение items, оно будет взято из values; 
  [+] KERNEL - Добавлен метод TMySQL->tableStatus возвращающий статус определенной таблицы; 
  [+] KERNEL - Добавлена функция arg для безопасного получения аргументов; 
  [+] ADMIN - В визуальный редактор добавлен формат "Блок", добавляющий элемент div; 
  [*] CLIENT - Изменен вывод форм ввода. Ширина задается не таблице а обрамляющему div, класс form, так же перенесен в div; 
  [*] KERNEL - Вместо события clientOnPathSplit вводится clientOnURLSplit, старое событие оставлено для обратной совместимости; 
  [+] KERNEL - Добавлена опция "clientPagesAtOnce" определяющая максимальное кол-во страниц отображаемое одновременно в переключателе страниц; 
  [+] ADMIN - В диалог "Еонфигурация - Прочее" добавлена опция "Показывать страниц одновременно (в переключателе страниц)" определяющая максимальное кол-во страниц отображаемое одновременно в переключателе страниц;

  2.00
  [*] ADMIN - визуальный редактор HTML FCKeditor заменен на Xinha.
  [#] CLIENT - Не выполнялась проверка полей формы на соответствие заданным условиям.
  [*] KERNEL - Изменен метод построения значения action в клиентских формах.
  [+] KERNEL - TClientUI - добавлен тип поля header
  [+] KERNEL - TClientUI - добавлен тип поля listbox
  [+] KERNEL - TAdminUI - добавлена проверка на наличие у полей имени
  [#] ADMIN - Нельзя было создать две страницы с одинаковым именем в разных разделах
  [+] KERNEL - Восстановлено поле TClientUI->section - массив содержащий заголовки всех родительских страниц.
  [*] ADMIN - Макрос Новости возвращает теперь заголовок только текущей страницы
  [+] AMDIN - Добавлен макрос Вышла CMS Eresus 2.00 - Новости - Главная возвращающий сборный заголовок текущей и всех родительских страниц
  [#] ADMIN - Не сохранялось значение опции "Выводить в обратном порядке" меню "Конфигурация"
  [+] DISTRIB - В дистрибутив включен инсталлятор.