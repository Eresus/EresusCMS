Скелет модуля
=============

Основной файл модуля
--------------------

Это единственный необходимый файл для создания модуля. Он должен иметь имя ``имя_плагина.php``, при этом имя должно записываться в нижнем регистре и может состоять из цифр, латинских букв и символа подчёркивания. Имя не может начинаться с цифры.

Файл должен содержать основной класс модуля.

Основной класс модуля
---------------------

Основной класс модуля должен быть унаследован от одного из базовых классов:

  * `Plugin <../../api/Eresus/Plugin.html>`_
  * `ContentPlugin <../../api/Eresus/ContentPlugin.html>`_

Имя класса плагина должно совпадать с именем плагина и, соответственно, его файла (пример: "MyPlugin").

Выбор базового класса
---------------------

Если ваш плагин должен :doc:`предоставлять тип контента (тип раздела)<../guide/providing_content_type>`, то он должен быть унаследован от `ContentPlugin <../../api/Eresus/ContentPlugin.html>`_.

Во всех остальных случаях в качестве базового класса следует использовать `Plugin <../../api/Eresus/Plugin.html>`_.

.. code-block:: php

   <?php
   /**
    * Тестовый плагин
    * @package Demo
    */
   class MyPlugin extends Plugin
   {
     ...
   }

Основные свойства модуля
------------------------

В объявлении основного класса плагина обязательно должен быть установлен ряд публичных свойств:

* `Plugin::$version <../../api/Eresus/Plugin.html#$version>`_ — строковое свойство, задающее версию плагина.
* `Plugin::$kernel <../../api/Eresus/Plugin.html#$kernel>`_ — строковое свойство, задающее минимальную необходимую для плагина версию CMS.
* `Plugin::$title <../../api/Eresus/Plugin.html#$title>`_ — строковое свойство, задающее название плагина.
* `Plugin::$description <../../api/Eresus/Plugin.html#$description>`_ — строковое свойство, задающее описание плагина.

Пример:

.. code-block:: php

   <?php
   /**
    * Тестовый плагин
    * @package Demo
    */
   class MyPlugin extends Plugin
   {
     /**
      * Версия плагина
      * @var string
      */
     public $version = '1.00b';

     /**
      * Требуемая версия ядра
      * @var string
      */
     public $kernel = '2.12';

     /**
      * Название плагина
      * @var string
      */
     public $title = 'Мой плагин';

     /**
      * Опиание плагина
      * @var string
      */
     public $description = 'Описание плагина';
   }


Итог
----

Кода, приведённого в последнем примере, достаточно для подключения вашего плагина к CMS. Скопируйте основной файл в папку ``ext/`` и попробуйте добавить его через управление модулями расширения.

Шаблон модуля
-------------

В дистрибутиве, в папке ``SDK/plugin_template`` расположена заготовка, которую вы можете использовать его для создания своего модуля. Этот шаблон состоит из следующих файлов и директорий:

* ''src/'' --- исходные коды модуля

  * ''myplugin/'' --- дополнительные файлы модуля (начиная с 2.16)

    * ''plugin.xml'' --- [[plugin.xml|описание модуля]]
  * ''myplugin.php'' --- [[cms:dev:manual:quick-start#основной файл модуля]]
* ''tests/'' --- автоматические тесты

  * ''phpunit'' --- тесты [[http://phpunit.de/|PHPUnit]] (до 2.16 папка называлась ''unit'')
* ''build.xml'' --- файл сборки для [[http://phing.info/|phing]]
* ''build.properties'' --- параметры сборки для ''build.xml''
